use std::{fs, io, path::Path};

pub fn count_loc(file_path: &Path) -> io::Result<u64> {
    Ok(fs::read_to_string(file_path)?.lines().count() as u64)
}

pub fn map_extension_to_file_type(path: &Path) -> Option<(&str, &'static str)> {
    let extension = path
        .extension()
        .unwrap_or_default()
        .to_str()
        .unwrap_or_default();

    let file_type = match extension {
        "abap" => Some("ABAP"),
        "abnf" => Some("ABNF"),
        "as" => Some("ActionScript"),
        "ada" | "adb" | "ads" | "pad" => Some("Ada"),
        "agda" => Some("Agda"),
        "x" => Some("Alex"),
        "als" => Some("Alloy"),
        "ino" => Some("Arduino C++"),
        "adoc" | "asciidoc" => Some("AsciiDoc"),
        "asn1" => Some("ASN.1"),
        "asa" | "asp" => Some("ASP"),
        "asax" | "ascx" | "asmx" | "aspx" | "master" | "sitemap" | "webinfo" => Some("ASP.NET"),
        "asm" => Some("Assembly"),
        "s" => Some("GNU Style Assembly"),
        "astro" => Some("Astro"),
        "dats" | "hats" | "sats" | "atxt" => Some("ATS"),
        "in" => Some("Autoconf"),
        "au3" => Some("Autoit"),
        "ahk" => Some("AutoHotKey"),
        "am" => Some("Automake"),
        "awk" => Some("AWK"),
        "bash" => Some("BASH"),
        "bat" | "btm" | "cmd" => Some("Batch"),
        "bzl" | "bazel" => Some("Bazel"),
        "bean" | "beancount" => Some("Bean"),
        "bb" | "bbclass" | "bbappend" | "inc" | "conf" => Some("Bitbake"),
        "brs" => Some("BrightScript"),
        "c" | "ec" | "pgc" => Some("C"),
        "cabal" => Some("Cabal"),
        "cassius" => Some("Cassius"),
        "ceylon" => Some("Ceylon"),
        "h" => Some("C Header"),
        "clj" => Some("Clojure"),
        "cljc" => Some("ClojureC"),
        "cljs" => Some("ClojureScript"),
        "cmake" => Some("CMake"),
        "cob" | "cbl" | "ccp" | "cobol" | "cpy" => Some("COBOL"),
        "ql" | "qll" => Some("CodeQL"),
        "coffee" | "cjsx" => Some("CoffeeScript"),
        "cogent" => Some("Cogent"),
        "cfm" => Some("ColdFusion"),
        "cfc" => Some("ColdFusion CFScript"),
        "v" => Some("Coq"),
        "cc" | "cpp" | "cxx" | "c++" | "pcc" | "tpp" => Some("C++"),
        "hh" | "hpp" | "hxx" | "inl" | "ipp" => Some("C++ Header"),
        "cr" => Some("Crystal"),
        "cs" | "csx" => Some("C#"),
        "csh" => Some("C Shell"),
        "css" => Some("CSS"),
        "cu" => Some("CUDA"),
        "pyx" | "pxd" | "pxi" => Some("Cython"),
        "d" => Some("D"),
        "daml" => Some("DAML"),
        "dart" => Some("Dart"),
        "dts" | "dtsi" => Some("Device Tree"),
        "dhall" => Some("Dhall"),
        "dockerfile" | "dockerignore" => Some("Dockerfile"),
        "resx" => Some(".NET Resource"),
        "dm" | "dme" => Some("Dream Maker"),
        "dust" => Some("Dust.js"),
        "ebuild" | "eclass" => Some("Ebuild"),
        "edgeql" => Some("EdgeQL"),
        "esdl" => Some("EdgeDB Schema Definition"),
        "edn" => Some("Edn"),
        "el" => Some("Emacs Lisp"),
        "ex" | "exs" => Some("Elixir"),
        "elm" => Some("Elm"),
        "elv" => Some("Elvish"),
        "ede" => Some("Emacs Dev Env"),
        "emojic" | "🍇" => Some("Emojicode"),
        "erl" | "hrl" => Some("Erlang"),
        "factor" => Some("Factor"),
        "fen" => Some("FEN"),
        "fnl" => Some("Fennel"),
        "fish" => Some("Fish"),
        "fbs" => Some("FlatBuffers Schema"),
        "cfg" => Some("Forge Config"),
        "4th" | "forth" | "fr" | "frt" | "fth" | "f83" | "fb" | "fpm" | "e4" | "rx" | "ft" => {
            Some("Forth")
        }
        "f" | "for" | "ftn" | "f77" | "pfo" => Some("FORTRAN Legacy"),
        "f03" | "f08" | "f90" | "f95" => Some("FORTRAN Modern"),
        "ftl" | "ftlh" | "ftlx" => Some("FreeMarker"),
        "fs" | "fsi" | "fsx" | "fsscript" => Some("F#"),
        "fst" => Some("F*"),
        "fut" => Some("Futhark"),
        "gdb" => Some("GDB Script"),
        "gd" => Some("GDScript"),
        "feature" => Some("Gherkin (Cucumber)"),
        "gleam" => Some("Gleam"),
        "vert" | "tesc" | "tese" | "geom" | "frag" | "comp" | "mesh" | "task" | "rgen" | "rint"
        | "rahit" | "rchit" | "rmiss" | "rcall" | "glsl" => Some("GLSL"),
        "gml" => Some("Gml"),
        "go" => Some("Go"),
        "gohtml" => Some("Go HTML"),
        "gql" | "graphql" => Some("GraphQL"),
        "groovy" | "grt" | "gtpl" | "gvy" => Some("Groovy"),
        "gw" => Some("Gwion"),
        "haml" => Some("Haml"),
        "hamlet" => Some("Hamlet"),
        "y" | "ly" => Some("Happy"),
        "hbs" | "handlebars" => Some("Handlebars"),
        "hs" => Some("Haskell"),
        "hx" => Some("Haxe"),
        "hcl" | "tf" | "tfvars" => Some("HCL"),
        "ha" => Some("Headache"),
        "hex" => Some("HEX"),
        "MAC" | "mac" => Some("HICAD"),
        "hlsl" => Some("HLSL"),
        "HC" | "hc" | "ZC" | "zc" => Some("HolyC"),
        "html" | "htm" => Some("HTML"),
        "hy" => Some("Hy"),
        "idr" | "lidr" => Some("Idris"),
        "ini" => Some("INI"),
        "ihex" => Some("Intel HEX"),
        "thy" => Some("Isabelle"),
        "jai" => Some("JAI"),
        "java" => Some("Java"),
        "cjs" | "js" | "mjs" => Some("JavaScript"),
        "j2" => Some("Jinja2"),
        "jq" => Some("jq"),
        "json" => Some("JSON"),
        "jsonnet" | "libsonnet" => Some("Jsonnet"),
        "jsx" => Some("JSX"),
        "jl" => Some("Julia"),
        "julius" => Some("Julius"),
        "ipynb" => Some("Jupyter Notebooks"),
        "k" => Some("K"),
        "kak" => Some("Kakoune script"),
        "kt" | "kts" => Some("Kotlin"),
        "ksh" => Some("Korn shell"),
        "kv" => Some("KV Language"),
        "lean" | "hlean" => Some("Lean"),
        "less" => Some("LESS"),
        "liquid" => Some("Liquid"),
        "ld" | "lds" => Some("LD Script"),
        "lisp" | "lsp" | "asd" => Some("Common Lisp"),
        "ls" => Some("LiveScript"),
        "ll" => Some("LLVM"),
        "lgt" | "logtalk" => Some("Logtalk"),
        "lol" => Some("LOLCODE"),
        "lua" => Some("Lua"),
        "lucius" => Some("Lucius"),
        "m4" => Some("M4"),
        "mad" => Some("Madlang"),
        "makefile" | "mak" | "mk" => Some("Makefile"),
        "md" | "markdown" => Some("Markdown"),
        "metal" => Some("Metal Shading Language"),
        "mint" => Some("Mint"),
        "mlt" => Some("Mlatu"),
        "def" => Some("Module-Definition"),
        "moon" => Some("MoonScript"),
        "csproj" | "vbproj" | "fsproj" | "props" | "targets" => Some("MSBuild"),
        "mustache" => Some("Mustache"),
        "nextflow" | "nf" => Some("Nextflow"),
        "nim" => Some("Nim"),
        "nix" => Some("Nix"),
        "nqp" => Some("Not Quite Perl"),
        "nu" => Some("Nushell"),
        "m" => Some("Objective-C"),
        "mm" => Some("Objective-C++"),
        "ml" | "mli" | "mll" | "mly" | "re" | "rei" => Some("OCaml"),
        "odin" => Some("Odin"),
        "rego" => Some("Open Policy Agent"),
        "fea" => Some("OpenType Feature File"),
        "org" => Some("Org"),
        "oz" => Some("Oz"),
        "pan" | "tpl" => Some("Pan"),
        "pas" => Some("Pascal"),
        "pl" | "pm" => Some("Perl"),
        "pest" => Some("Pest"),
        "php" => Some("PHP"),
        "pk" => Some("Poke"),
        "polly" => Some("Polly"),
        "pony" => Some("Pony"),
        "pcss" | "sss" => Some("PostCSS"),
        "ps1" | "psm1" | "psd1" | "ps1xml" | "cdxml" | "pssc" | "psc1" => Some("PowerShell"),
        "pde" => Some("Processing"),
        "p" | "pro" => Some("Prolog"),
        "psl" => Some("PSL Assertion"),
        "proto" => Some("Protocol Buffers"),
        "pug" => Some("Pug"),
        "pp" => Some("Puppet"),
        "purs" => Some("PureScript"),
        "py" | "pyw" => Some("Python"),
        "q" => Some("Q"),
        "qcl" => Some("QCL"),
        "qml" => Some("QML"),
        "r" => Some("R"),
        "rkt" | "scrbl" => Some("Racket"),
        "rake" => Some("Rakefile"),
        "raku" | "rakumod" | "rakutest" | "pm6" | "pl6" | "p6" => Some("Raku"),
        "cshtml" => Some("Razor"),
        "reds" => Some("Redscript"),
        "rpy" => Some("Ren'Py"),
        "res" | "resi" => Some("ReScript"),
        "rst" => Some("ReStructuredText"),
        "ron" => Some("Rusty Object Notation"),
        "spec" => Some("RPM Specfile"),
        "rb" => Some("Ruby"),
        "rhtml" | "erb" => Some("Ruby HTML"),
        "rs" => Some("Rust"),
        "sass" | "scss" => Some("Sass"),
        "sc" | "scala" => Some("Scala"),
        "scm" | "ss" => Some("Scheme"),
        "sh" => Some("Shell"),
        "shader" | "cginc" => Some("ShaderLab"),
        "sml" => Some("Standard ML (SML)"),
        "cs.st" | "pck.st" => Some("Smalltalk"),
        "sol" => Some("Solidity"),
        "e" => Some("Specman e"),
        "ckt" => Some("Spice Netlist"),
        "sql" => Some("SQL"),
        "sqf" => Some("SQF"),
        "srt" => Some("SRecode Template"),
        "stan" => Some("Stan"),
        "str" => Some("Stratego/XT"),
        "styl" => Some("Stylus"),
        "svelte" => Some("Svelte"),
        "svg" => Some("SVG"),
        "swift" => Some("Swift"),
        "swg" | "i" => Some("SWIG"),
        "sv" | "svh" => Some("SystemVerilog"),
        "tcl" => Some("TCL"),
        "tera" => Some("Tera"),
        "tex" | "sty" => Some("TeX"),
        "text" | "txt" => Some("Plain Text"),
        "thrift" => Some("Thrift"),
        "toml" => Some("TOML"),
        "tsx" => Some("TSX"),
        "ttcn" | "ttcn3" | "ttcnpp" => Some("TTCN-3"),
        "twig" => Some("Twig"),
        "ts" => Some("TypeScript"),
        "umpl" => Some("UMPL"),
        "u" => Some("Unison"),
        "udn" => Some("Unreal Markdown"),
        "uplugin" => Some("Unreal Plugin"),
        "uproject" => Some("Unreal Project"),
        "uc" | "uci" | "upkg" => Some("Unreal Script"),
        "usf" => Some("Unreal Shader"),
        "ush" => Some("Unreal Shader Header"),
        "ur" | "urs" => Some("Ur/Web"),
        "urp" => Some("Ur/Web Project"),
        "vala" => Some("Vala"),
        "frm" | "bas" | "cls" => Some("VB6"),
        "vbs" => Some("VBScript"),
        "vm" => Some("Apache Velocity"),
        "vg" | "vh" => Some("Verilog"),
        "irunargs" | "xrunargs" => Some("Verilog Args File"),
        "vhd" | "vhdl" => Some("VHDL"),
        "vb" => Some("Visual Basic"),
        "vcproj" | "vcxproj" => Some("Visual Studio Project"),
        "sln" => Some("Visual Studio Solution"),
        "vim" => Some("Vim Script"),
        "vue" => Some("Vue"),
        "wat" | "wast" => Some("WebAssembly"),
        "wy" => Some("The WenYan Programming Language"),
        "wgsl" => Some("WebGPU Shader Language"),
        "nb" | "wl" => Some("Wolfram"),
        "xaml" => Some("XAML"),
        "xcconfig" => Some("Xcode Config"),
        "xml" => Some("XML"),
        "xsl" | "xslt" => Some("XSL"),
        "xtend" => Some("Xtend"),
        "yaml" | "yml" => Some("YAML"),
        "zs" => Some("ZenCode"),
        "zig" => Some("Zig"),
        "zsh" => Some("Zsh"),
        _ => None,
    };

    file_type.map(|file_type| (extension, file_type))
}
